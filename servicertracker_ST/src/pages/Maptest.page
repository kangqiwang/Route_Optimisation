<apex:page controller="MapControllertest" showHeader="true" sidebar="false">
    <html>
        <head>    
            <title>Route Optimisation</title>
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
            <script src="https://api.mqcdn.com/sdk/mapquest-js/v1.3.1/mapquest.js"></script>
            <link rel="stylesheet" href="https://api.mqcdn.com/sdk/mapquest-js/v1.3.1/mapquest.css"/>
            <style>
                #date_container{
                display: flex;
                justify-content: center;
                }
                
                
                
            </style>
            
            
            <script type="text/javascript">
            var resources = [];
            var territories = [];
            window.onload = function() {
                L.mapquest.key = 'XFI9f8gkExRTk58rq7jyxDSMgkgt06KV';
                
                var map = L.mapquest.map('map', {
                    center: [40.7128, -74.0059],
                    layers: L.mapquest.tileLayer('map'),
                    zoom: 13
                });
                map.addControl(L.mapquest.control());
                L.mapquest.directions().route({
                    start: '350 5th Ave, New York, NY 10118',
                    end: 'One Liberty Plaza, New York, NY 10006'
                });
                
                
                
                <apex:repeat value="{!objectResource}" var="resource" id="resources">
                    var pResource=document.createElement("label");
                var node=document.createTextNode('{!resource.name}');
                var element=document.getElementById("resource");
                pResource.appendChild(node);
                element.appendChild(pResource);
                var checkboxResource=document.createElement("input");
                checkboxResource.setAttribute('type', 'checkbox');
                element.appendChild(checkboxResource);
                
                
                var resource ={
                    name: '{!resource.name}',
                    id: '{!resource.id}'
                };
                resources.push(resource);
                
                </apex:repeat>
                // console.log(resources);
                //  console.log(resources.length);
                
                <apex:repeat value="{!objectTerritory}" var="territory" id="territories">
                    var pResource=document.createElement("label");
                var node=document.createTextNode('{!territory.name}');
                var element=document.getElementById("territory");
                pResource.appendChild(node);
                element.appendChild(pResource);
                var checkboxResource=document.createElement("input");
                checkboxResource.setAttribute('type', 'checkbox');
                element.appendChild(checkboxResource);
                
                var territory ={
                    name: '{!territory.name}'
                };
                console.log('{!territory.name}');
                
                </apex:repeat>
            }
            
            
            
            
            $(document).ready(function(){
                
                var formValue=$("#matrixForm").val();
                console.log('form data' + formValue);
                //js json Ajax
                $("#matrixForm").submit(function(event){
                    //prevent send request
                    event.preventDefault();
                    // set the lantitude and longtitude
                    var locations= new Array();
                    locations[0]="51.4816, 3.1791";
                    locations[1]="51.5788, 3.2181";
                    locations[2]="51.5842,2.9977";
                    var options= new Array();
                    var allToAll=new Object();
                    
                    
                    
                    //var mappingJson=JSON.stringify({locations,options:allToAll});
                    var mappingJson = `{ "locations": [ "Cardiff, CO", "Westminster, CO", "Boulder, CO"], "options": { "allToAll": true }}`;

                    $.ajax({
                        type: 'POST',
                        dataType: 'jsonp',
                        contentType: 'json',
                        url: "http://www.mapquestapi.com/directions/v2/routematrix",
                        data: {key: decodeURI("XFI9f8gkExRTk58rq7jyxDSMgkgt06KV"),
                               json: mappingJson},
                        
                        success: function(data){
                            console.log('form was submit,' + data.time);
                        },
                        error: function(data){
                            console.log("error");
                        },
                    });
                });
                
            });
            
            //input : latitude, longitude. output : show the map
            function renderMap(latitude, longitude){
                
            }
            // generate the Json file
            //input :specific date and resource, territory output: the location 
            function getLocation(data){
            	
            }
            
            //input: data from the mapquest response. output: the time and distance
            function getTravelTime(data){}
            
            /*
          function getdistance() {
          var mappingJson='';
          mappingJson += '{ locations: [ "Denver, CO", "Westminster, CO", "Boulder, CO"], "options": { "allToAll": true }}';
          $.ajax({
          url: 'https://www.mapquestapi.com/directions/v2/routematrix',
          crossDomain: true,
          dataType: 'jsonp',
          
          type: 'POST',
          data:{
          	key: decodeURI("XFI9f8gkExRTk58rq7jyxDSMgkgt06KV"),
          	json: JSON.stringify({ "location" : [ "Cardiff, GB", "Caerphilly, GB", "Newport, GB"], "options": { "allToAll": true}})
          },
          success: function(data){ console.log(data);},
          error: function(data) {
          	console.log('error occurred -' + data);
          },
          beforeSend: setHeader,

      });
      */
            //          var xmlhttp= new XMLHttpRequest();
            //if (this.readyState == 4 && this.status == 200) 
            //{
            //            document.getElementById("availablityResults").innerHTML=this.responseText;
            //}
            //xmlhttp.open("POST", "https://www.mapquestapi.com/directions/v2/routematrix?key=XFI9f8gkExRTk58rq7jyxDSMgkgt06KV", true);
            //xmlhttp.setRequestHeader("Content-Type", "application/json");
            //xmlhttp.send(JSON.stringify({ "location" : [ "Cardiff, GB", "Caerphilly, GB", "Newport, GB"], "options": { "allToAll": true}}));
            //console.log(xmlhttp.responseText);
            //}
            
            </script>
            
        </head>
        <body>
            <apex:pageBlock title="Route Optimisation">
                
                <form id="matrixForm" method="POST" action="http://www.mapquestapi.com/directions/v2/routematrix?key=XFI9f8gkExRTk58rq7jyxDSMgkgt06KV">
                    <div id="date_container">
                        
                        <div>
                            <label>From Date </label>
                            <input type="date" id="fromDate"/>    
                        </div>
                        <div style='width: 30%;'></div>
                        
                        <div style='float:left;'>
                            <label>To Date</label>
                            <input type="date" id="toDate"/>    
                        </div>
                    </div>
                    
                    
                    <div id="resource">
                        
                    </div>
                    
                    
                    <div id="territory">
                        
                    </div>
                    <div>
                        <input type="submit" name="submit" value="Find Nearest Tech"/>    
                    </div>
                    
                </form>https://eu8.salesforce.com/_ui/common/apex/debug/ApexCSIPage#
                <div id="result" style="display: none;">
                    <div class="header">
                    </div>
                    
                    <br/>
                    
                    <div id="map" style="width: 100%; height: 530px; display: none;"></div>
                    
                    <div class="individual">
                    </div>
                    <div class="route"></div>
                </div>
            </apex:pageBlock>
        </body>
    </html>
</apex:page>